<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tutoring | Gwinnett County Resource Hub</title>
    <link rel="icon" type="image/png" href="../favicon-gwinnett.png">

    <link rel="stylesheet" href="../styles.css">

    <style>
        .wrap {
            max-width: 1150px;
            margin: 0 auto;
            padding: 18px 14px 44px;
        }
        
        .top {
            margin-top: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: flex-end;
            justify-content: space-between;
        }
        
        .title {
            margin: 0;
            font-size: 1.55rem;
            font-weight: 850;
            color: var(--sandText);
        }
        
        .sub {
            margin: 6px 0 0;
            color: var(--mutedText);
            max-width: 85ch;
            line-height: 1.45;
        }
        
        .actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .btn {
            appearance: none;
            border: 1px solid var(--border);
            background: rgba(255, 255, 255, .06);
            color: var(--sandText);
            padding: 10px 12px;
            border-radius: 14px;
            cursor: pointer;
            font-weight: 800;
            transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
        }
        
        .btn:hover {
            background: rgba(255, 255, 255, .10);
            border-color: rgba(176, 109, 76, .6);
            transform: translateY(-1px);
        }
        
        .btn.primary {
            background: rgba(176, 109, 76, .92);
            border-color: rgba(255, 255, 255, .16);
            color: white;
        }
        
        .btn.primary:hover {
            background: rgba(47, 91, 59, .92);
            border-color: rgba(255, 255, 255, .22);
        }
        
        .filters {
            margin-top: 14px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: flex-end;
            padding: 12px;
            border-radius: 16px;
            border: 1px solid var(--border);
            background: rgba(255, 255, 255, .04);
        }
        
        .field {
            display: flex;
            flex-direction: column;
            gap: 6px;
            min-width: 220px;
        }
        
        .field label {
            font-size: .85rem;
            font-weight: 800;
            color: rgba(233, 225, 214, .78);
        }
        
        .input,
        .select {
            background: rgba(255, 255, 255, .04);
            border: 1px solid var(--border);
            color: var(--sandText);
            border-radius: 14px;
            padding: 10px 12px;
            outline: none;
            font-size: .98rem;
        }
        
        .input::placeholder {
            color: rgba(233, 225, 214, .55);
        }
        
        .meta-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 14px;
            color: var(--mutedText);
        }
        
        .grid {
            margin-top: 10px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }
        
        .card {
            border: 1px solid var(--border);
            background: rgba(255, 255, 255, .04);
            border-radius: 18px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }
        
        .card-top {
            display: flex;
            gap: 12px;
            padding: 14px;
            align-items: flex-start;
        }
        
        .logo {
            width: 54px;
            height: 54px;
            border-radius: 14px;
            border: 1px solid rgba(233, 225, 214, .14);
            background: rgba(0, 0, 0, .18);
            display: grid;
            place-items: center;
            font-weight: 900;
            color: rgba(233, 225, 214, .85);
            flex: 0 0 auto;
        }
        
        .name {
            margin: 0;
            font-size: 1.05rem;
            font-weight: 900;
            color: var(--sandText);
        }
        
        .price {
            margin: 6px 0 0;
            color: rgba(255, 255, 255, .86);
            font-weight: 800;
        }
        
        .subjects {
            margin: 8px 0 0;
            color: var(--mutedText);
            line-height: 1.35;
        }
        
        .tags {
            margin-top: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .tag {
            padding: 6px 10px;
            border-radius: 999px;
            border: 1px solid rgba(233, 225, 214, .12);
            background: rgba(0, 0, 0, .12);
            color: rgba(233, 225, 214, .85);
            font-weight: 800;
            font-size: .8rem;
        }
        
        .card-foot {
            border-top: 1px solid rgba(233, 225, 214, .10);
            background: rgba(0, 0, 0, .08);
            padding: 12px 14px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }
        
        .small {
            font-size: .88rem;
            color: rgba(233, 225, 214, .72);
        }
        
        .empty {
            margin-top: 12px;
            padding: 18px;
            border-radius: 18px;
            border: 1px dashed rgba(233, 225, 214, .22);
            background: rgba(255, 255, 255, .03);
            text-align: center;
            color: var(--mutedText);
        }
        /* Modal */
        
        .modal-scrim {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, .65);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 90;
            padding: 16px;
        }
        
        .modal-scrim.open {
            display: flex;
        }
        
        .modal {
            width: min(720px, 96vw);
            background: var(--soil);
            border: 1px solid var(--border);
            border-radius: 18px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }
        
        .modal-head {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 14px;
            border-bottom: 1px solid var(--border);
        }
        
        .modal-head h3 {
            margin: 0;
            font-size: 1.05rem;
            font-weight: 900;
            color: var(--sandText);
        }
        
        .modal-body {
            padding: 14px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .help {
            color: rgba(233, 225, 214, .72);
            font-size: .9rem;
            line-height: 1.35;
            margin: 0;
        }
        
        .modal-foot {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            padding: 12px 14px;
            border-top: 1px solid var(--border);
            background: rgba(255, 255, 255, .02);
        }
        
        .ghost {
            background: rgba(255, 255, 255, .04);
        }
        
        @media (max-width: 980px) {
            .grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 680px) {
            .grid {
                grid-template-columns: 1fr;
            }
            .field {
                min-width: unset;
                width: 100%;
            }
            .row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>

    <header class="topbar">
        <a class="brand-pill" href="../index.html" aria-label="Go to home">
            <span class="brand-dot" aria-hidden="true">GC</span>
            <span>Community Hub</span>
        </a>
        <h1 class="site-title">Gwinnett County Resource Hub</h1>
        <button class="menu-btn" id="menuBtn" aria-label="Open menu">
            <span class="burger" id="burgerIcon"></span>
        </button>
    </header>

    <div class="scrim" id="scrim" hidden></div>

    <aside class="sidebar" id="sidebar" aria-hidden="true">
        <div class="sidebar-header">
            <h2>Menu</h2>
            <button class="close-btn" id="closeBtn" aria-label="Close menu">X</button>
        </div>

        <nav class="side-nav">
            <a class="nav-item" href="../index.html">Home</a>
            <button class="nav-item drop-btn" data-drop="connecting" aria-expanded="false">
                Connecting <span>v</span>
            </button>

            <div class="drop-panel" id="connecting">
                <a class="nav-sub" href="../Connecting/forum.html">Forum</a>
                <a class="nav-sub" href="../Connecting/scholarship.html">Scholarships</a>
                <a class="nav-sub" href="../Connecting/tutoring.html">Tutoring</a>
            </div>

            <button class="nav-item drop-btn" data-drop="countywide" aria-expanded="false">
                County-Wide <span>v</span>
            </button>

            <div class="drop-panel" id="countywide">
                <a class="nav-sub" href="../County-Wide/activities.html">Activities</a>
                <a class="nav-sub" href="../County-Wide/awards.html">Awards</a>
                <a class="nav-sub" href="../County-Wide/news.html">News</a>
            </div>

            <a class="nav-item" href="../mentalhealth.html">Emotional / Mental Programs</a>
            <a class="nav-item" href="../feedback.html">Feedback Form</a>
            <a class="nav-item" href="../references.html">References</a>

        </nav>
    </aside>

    <main class="wrap">
        <div class="top">
            <div>
                <h2 class="title">Tutoring Directory</h2>
                <p class="sub">
                    This is a demo directory. Students can browse tutoring options and (locally) add new listings. Listings are saved to your browser only.
                </p>
            </div>

            <div class="actions">
                <button class="btn" id="clearBtn" type="button">Clear</button>
                <button class="btn primary" id="newBtn" type="button">Advertise Your Tutoring</button>
            </div>
        </div>

        <section class="filters">
            <div class="field" style="flex:1; min-width: 260px;">
                <label for="search">Search</label>
                <input class="input" id="search" placeholder="Search business name or subject..." />
            </div>

            <div class="field">
                <label for="subjectFilter">Subject filter</label>
                <select class="select" id="subjectFilter">
        <option value="All">All</option>
        <option value="Math">Math</option>
        <option value="Science">Science</option>
        <option value="English">English</option>
        <option value="History">History</option>
        <option value="Languages">Languages</option>
        <option value="SAT/ACT">SAT/ACT</option>
        <option value="Computer Science">Computer Science</option>
        <option value="Music/Art">Music/Art</option>
        <option value="Other">Other</option>
      </select>
            </div>

            <div class="field">
                <label for="sort">Sort</label>
                <select class="select" id="sort">
        <option value="new">Newest</option>
        <option value="low">$ Price (low to high)</option>
        <option value="high">$ Price (high to low)</option>
        <option value="az">Name (A–Z)</option>
      </select>
            </div>

            <button class="btn" id="resetBtn" type="button">Reset</button>
        </section>

        <div class="meta-row">
            <div id="countText">Showing 0 listings</div>
            <div class="small">Tip: add multiple subjects separated by commas.</div>
        </div>

        <section class="grid" id="grid"></section>
        <div class="empty" id="empty" hidden>No tutoring listings match your search/filter.</div>
    </main>

    <!-- Modal -->
    <div class="modal-scrim" id="modalScrim" aria-hidden="true">
        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
            <div class="modal-head">
                <h3 id="modalTitle">Advertise Your Tutoring</h3>
                <button class="btn ghost" id="closeModal" type="button">✕</button>
            </div>

            <div class="modal-body">
                <p class="help">
                    Logo upload is just for the form feel (demo). Your listing will still appear even if you don’t upload anything.
                </p>

                <div class="row">
                    <div class="field">
                        <label for="logo">Logo (optional)</label>
                        <input class="input" id="logo" type="file" accept="image/*">
                    </div>

                    <div class="field">
                        <label for="price">Price</label>
                        <input class="input" id="price" placeholder="e.g., $25/hr" maxlength="20">
                    </div>
                </div>

                <div class="field">
                    <label for="biz">Business name</label>
                    <input class="input" id="biz" placeholder="e.g., Peachtree Prep Tutoring" maxlength="50">
                </div>

                <div class="field">
                    <label for="subjects">Subjects taught</label>
                    <input class="input" id="subjects" placeholder="e.g., Algebra, Geometry, SAT/ACT, Chemistry" maxlength="80">
                </div>
            </div>

            <div class="modal-foot">
                <button class="btn ghost" id="cancelModal" type="button">Cancel</button>
                <button class="btn primary" id="submit" type="button">Add Listing</button>
            </div>
        </div>
    </div>

    <script>
        const STORAGE_KEY = "gc_resourcehub_tutoring_listings_v1";

        const grid = document.getElementById("grid");
        const empty = document.getElementById("empty");
        const countText = document.getElementById("countText");

        const searchEl = document.getElementById("search");
        const subjectFilter = document.getElementById("subjectFilter");
        const sortEl = document.getElementById("sort");
        const resetBtn = document.getElementById("resetBtn");

        const clearBtn = document.getElementById("clearBtn");
        const newBtn = document.getElementById("newBtn");

        const modalScrim = document.getElementById("modalScrim");
        const closeModalBtn = document.getElementById("closeModal");
        const cancelModalBtn = document.getElementById("cancelModal");
        const submitBtn = document.getElementById("submit");

        const logoEl = document.getElementById("logo");
        const priceEl = document.getElementById("price");
        const bizEl = document.getElementById("biz");
        const subjectsEl = document.getElementById("subjects");

        function uid() {
            return Math.random().toString(16).slice(2) + Date.now().toString(16);
        }

        function load() {
            try {
                const raw = localStorage.getItem(STORAGE_KEY);
                if (!raw) return null;
                const parsed = JSON.parse(raw);
                return Array.isArray(parsed) ? parsed : null;
            } catch {
                return null;
            }
        }

        function save() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(listings));
        }

        // Fake starter businesses
        const seed = [{
            id: uid(),
            createdAt: Date.now() - 1000 * 60 * 60 * 24 * 2,
            name: "Peachtree Prep Tutoring",
            price: "$25/hr",
            subjects: ["Algebra", "Geometry", "SAT/ACT"],
            logoText: "PP"
        }, {
            id: uid(),
            createdAt: Date.now() - 1000 * 60 * 60 * 24 * 5,
            name: "Lanier Science Boost",
            price: "$30/hr",
            subjects: ["Biology", "Chemistry", "Physics", "Science"],
            logoText: "LS"
        }, {
            id: uid(),
            createdAt: Date.now() - 1000 * 60 * 60 * 24 * 1,
            name: "Gwinnett Writing Lab",
            price: "$20/hr",
            subjects: ["English", "Essay Help", "Reading", "History"],
            logoText: "GW"
        }];

        // Load existing or use seed
        let listings = load();
        if (!listings) {
            listings = seed;
            save();
        }

        function openModal() {
            modalScrim.classList.add("open");
            modalScrim.setAttribute("aria-hidden", "false");
            // clear form
            logoEl.value = "";
            priceEl.value = "";
            bizEl.value = "";
            subjectsEl.value = "";
            bizEl.focus();
        }

        function closeModal() {
            modalScrim.classList.remove("open");
            modalScrim.setAttribute("aria-hidden", "true");
        }

        newBtn.addEventListener("click", openModal);
        closeModalBtn.addEventListener("click", closeModal);
        cancelModalBtn.addEventListener("click", closeModal);
        modalScrim.addEventListener("click", (e) => {
            if (e.target === modalScrim) closeModal();
        });

        function normalizeSubjects(text) {
            return text
                .split(",")
                .map(s => s.trim())
                .filter(Boolean);
        }

        function bestLogoText(name) {
            const parts = name.trim().split(/\s+/).filter(Boolean);
            const letters = parts.slice(0, 2).map(p => p[0].toUpperCase()).join("");
            return letters || "TU";
        }

        function priceToNumber(p) {
            // extracts first number it sees, for sorting
            const m = String(p || "").match(/(\d+(\.\d+)?)/);
            return m ? parseFloat(m[1]) : Number.POSITIVE_INFINITY;
        }

        function matchesSubject(listing, filter) {
            if (filter === "All") return true;
            const subs = (listing.subjects || []).map(s => s.toLowerCase());
            const f = filter.toLowerCase();

            // match if any subject contains the filter word
            return subs.some(s => s.includes(f));
        }

        function matchesSearch(listing, q) {
            if (!q) return true;
            const hay = [
                listing.name,
                listing.price,
                ...(listing.subjects || [])
            ].join(" ").toLowerCase();
            return hay.includes(q);
        }

        function render() {
            const q = (searchEl.value || "").trim().toLowerCase();
            const filter = subjectFilter.value;
            const sort = sortEl.value;

            let items = [...listings]
                .filter(l => matchesSubject(l, filter))
                .filter(l => matchesSearch(l, q));

            if (sort === "new") {
                items.sort((a, b) => (b.createdAt || 0) - (a.createdAt || 0));
            } else if (sort === "az") {
                items.sort((a, b) => (a.name || "").localeCompare(b.name || ""));
            } else if (sort === "low") {
                items.sort((a, b) => priceToNumber(a.price) - priceToNumber(b.price));
            } else if (sort === "high") {
                items.sort((a, b) => priceToNumber(b.price) - priceToNumber(a.price));
            }

            grid.innerHTML = "";
            countText.textContent = `Showing ${items.length} listing${items.length === 1 ? "" : "s"}`;
            empty.hidden = items.length !== 0;

            items.forEach(l => {
                        const card = document.createElement("article");
                        card.className = "card";

                        const subjects = (l.subjects || []).slice(0, 10);

                        card.innerHTML = `
        <div class="card-top">
          <div class="logo">${escapeHtml(l.logoText || "TU")}</div>
          <div style="min-width:0;">
            <h3 class="name">${escapeHtml(l.name)}</h3>
            <div class="price">${escapeHtml(l.price)}</div>
            <div class="subjects">Subjects:</div>
            <div class="tags">
              ${subjects.map(s => `<span class="tag">${escapeHtml(s)}</span>`).join("")}
            </div>
          </div>
        </div>

        <div class="card-foot">
          <div class="small">Demo listing (saved on this device)</div>
          <div class="small">${new Date(l.createdAt || Date.now()).toLocaleDateString()}</div>
        </div>
      `;

      grid.appendChild(card);
    });
  }

  function escapeHtml(str){
    return String(str || "")
      .replaceAll("&", "&amp;")
      .replaceAll("<", "&lt;")
      .replaceAll(">", "&gt;")
      .replaceAll('"', "&quot;")
      .replaceAll("'", "&#039;");
  }

  submitBtn.addEventListener("click", () => {
    const name = bizEl.value.trim();
    const price = priceEl.value.trim();
    const subjectsText = subjectsEl.value.trim();

    if (!name){
      alert("Please enter a business name.");
      bizEl.focus();
      return;
    }
    if (!price){
      alert("Please enter a price (example: $25/hr).");
      priceEl.focus();
      return;
    }
    if (!subjectsText){
      alert("Please enter at least one subject (comma-separated).");
      subjectsEl.focus();
      return;
    }

    const newListing = {
      id: uid(),
      createdAt: Date.now(),
      name,
      price,
      subjects: normalizeSubjects(subjectsText),
      logoText: bestLogoText(name)
    };

    listings.push(newListing);
    save();
    closeModal();
    render();
  });

  resetBtn.addEventListener("click", () => {
    searchEl.value = "";
    subjectFilter.value = "All";
    sortEl.value = "new";
    render();
  });

  clearBtn.addEventListener("click", () => {
    const ok = confirm("Clear all tutoring listings on this device?");
    if (!ok) return;
    listings = [];
    save();
    render();
  });

  searchEl.addEventListener("input", render);
  subjectFilter.addEventListener("change", render);
  sortEl.addEventListener("change", render);

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") closeModal();
  });

  render();
    </script>

    <script src="../menu.js"></script>
</body>

</html>